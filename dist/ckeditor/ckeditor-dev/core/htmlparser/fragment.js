/*
 Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.
 For licensing, see LICENSE.md or http://ckeditor.com/license
*/
CKEDITOR.htmlParser.fragment=function(){this.children=[];this.parent=null;this._={isBlockLike:!0,hasInlineStarted:!1}};
(function(){function u(b){return b.attributes["data-cke-survive"]?!1:"a"==b.name&&b.attributes.href||CKEDITOR.dtd.$removeEmpty[b.name]}var v=CKEDITOR.tools.extend({table:1,ul:1,ol:1,dl:1},CKEDITOR.dtd.table,CKEDITOR.dtd.ul,CKEDITOR.dtd.ol,CKEDITOR.dtd.dl),w={ol:1,ul:1},x=CKEDITOR.tools.extend({},{html:1},CKEDITOR.dtd.html,CKEDITOR.dtd.body,CKEDITOR.dtd.head,{style:1,script:1}),B={ul:"li",ol:"li",dl:"dd",table:"tbody",tbody:"tr",thead:"tr",tfoot:"tr",tr:"td"};CKEDITOR.htmlParser.fragment.fromHtml=
function(b,a,e){function f(d){var g;if(0<l.length)for(var a=0;a<l.length;a++){var b=l[a],e=b.name,f=CKEDITOR.dtd[e],h=c.name&&CKEDITOR.dtd[c.name];h&&!h[e]||d&&f&&!f[d]&&CKEDITOR.dtd[d]?e==c.name&&(p(c,c.parent,1),a--):(g||(m(),g=1),b=b.clone(),b.parent=c,c=b,l.splice(a,1),a--)}}function m(){for(;t.length;)p(t.shift(),c)}function y(d){if(d._.isBlockLike&&"pre"!=d.name&&"textarea"!=d.name){var g=d.children.length,a=d.children[g-1],c;a&&a.type==CKEDITOR.NODE_TEXT&&((c=CKEDITOR.tools.rtrim(a.value))?
a.value=c:d.children.length=g-1)}}function p(d,g,a){g=g||c||n;var b=c;void 0===d.previous&&(z(g,d)&&(c=g,h.onTagOpen(e,{}),d.returnPoint=g=c),y(d),u(d)&&!d.children.length||g.add(d),"pre"==d.name&&(q=!1),"textarea"==d.name&&(r=!1));d.returnPoint?(c=d.returnPoint,delete d.returnPoint):c=a?g:b}function z(d,g){if((d==n||"body"==d.name)&&e&&(!d.name||CKEDITOR.dtd[d.name][e])){var a,c;return(a=g.attributes&&(c=g.attributes["data-cke-real-element-type"])?c:g.name)&&a in CKEDITOR.dtd.$inline&&!(a in CKEDITOR.dtd.head)&&
!g.isOrphan||g.type==CKEDITOR.NODE_TEXT}}function A(d,a){return d in CKEDITOR.dtd.$listItem||d in CKEDITOR.dtd.$tableContent?d==a||"dt"==d&&"dd"==a||"dd"==d&&"dt"==a:!1}var h=new CKEDITOR.htmlParser,n=a instanceof CKEDITOR.htmlParser.element?a:"string"==typeof a?new CKEDITOR.htmlParser.element(a):new CKEDITOR.htmlParser.fragment,l=[],t=[],c=n,r="textarea"==n.name,q="pre"==n.name;h.onTagOpen=function(d,a,b,e){a=new CKEDITOR.htmlParser.element(d,a);a.isUnknown&&b&&(a.isEmpty=!0);a.isOptionalClose=e;
if(u(a))l.push(a);else{if("pre"==d)q=!0;else{if("br"==d&&q){c.add(new CKEDITOR.htmlParser.text("\n"));return}"textarea"==d&&(r=!0)}if("br"==d)t.push(a);else{for(;!(e=(b=c.name)?CKEDITOR.dtd[b]||(c._.isBlockLike?CKEDITOR.dtd.div:CKEDITOR.dtd.span):x,a.isUnknown||c.isUnknown||e[d]);)if(c.isOptionalClose)h.onTagClose(b);else if(d in w&&b in w)b=c.children,(b=b[b.length-1])&&"li"==b.name||p(b=new CKEDITOR.htmlParser.element("li"),c),!a.returnPoint&&(a.returnPoint=c),c=b;else if(d in CKEDITOR.dtd.$listItem&&
!A(d,b))h.onTagOpen("li"==d?"ul":"dl",{},0,1);else if(b in v&&!A(d,b))!a.returnPoint&&(a.returnPoint=c),c=c.parent;else if(b in CKEDITOR.dtd.$inline&&l.unshift(c),c.parent)p(c,c.parent,1);else{a.isOrphan=1;break}f(d);m();a.parent=c;a.isEmpty?p(a):c=a}}};h.onTagClose=function(a){for(var b=l.length-1;0<=b;b--)if(a==l[b].name){l.splice(b,1);return}for(var f=[],h=[],k=c;k!=n&&k.name!=a;)k._.isBlockLike||h.unshift(k),f.push(k),k=k.returnPoint||k.parent;if(k!=n){for(b=0;b<f.length;b++){var q=f[b];p(q,q.parent)}c=
k;k._.isBlockLike&&m();p(k,k.parent);k==c&&(c=c.parent);l=l.concat(h)}"body"==a&&(e=!1)};h.onText=function(a){if(!(c._.hasInlineStarted&&!t.length||q||r)&&(a=CKEDITOR.tools.ltrim(a),0===a.length))return;var b=c.name,l=b?CKEDITOR.dtd[b]||(c._.isBlockLike?CKEDITOR.dtd.div:CKEDITOR.dtd.span):x;if(!r&&!l["#"]&&b in v)h.onTagOpen(B[b]||""),h.onText(a);else{m();f();q||r||(a=a.replace(/[\t\r\n ]{2,}|[\t\r\n]/g," "));a=new CKEDITOR.htmlParser.text(a);if(z(c,a))this.onTagOpen(e,{},0,1);c.add(a)}};h.onCDATA=
function(a){c.add(new CKEDITOR.htmlParser.cdata(a))};h.onComment=function(a){m();f();c.add(new CKEDITOR.htmlParser.comment(a))};h.parse(b);for(m();c!=n;)p(c,c.parent,1);y(n);return n};CKEDITOR.htmlParser.fragment.prototype={type:CKEDITOR.NODE_DOCUMENT_FRAGMENT,add:function(b,a){isNaN(a)&&(a=this.children.length);var e=0<a?this.children[a-1]:null;if(e){if(b._.isBlockLike&&e.type==CKEDITOR.NODE_TEXT&&(e.value=CKEDITOR.tools.rtrim(e.value),0===e.value.length)){this.children.pop();this.add(b);return}e.next=
b}b.previous=e;b.parent=this;this.children.splice(a,0,b);this._.hasInlineStarted||(this._.hasInlineStarted=b.type==CKEDITOR.NODE_TEXT||b.type==CKEDITOR.NODE_ELEMENT&&!b._.isBlockLike)},filter:function(b,a){a=this.getFilterContext(a);b.onRoot(a,this);this.filterChildren(b,!1,a)},filterChildren:function(b,a,e){if(this.childrenFilteredBy!=b.id){e=this.getFilterContext(e);if(a&&!this.parent)b.onRoot(e,this);this.childrenFilteredBy=b.id;for(a=0;a<this.children.length;a++)!1===this.children[a].filter(b,
e)&&a--}},writeHtml:function(b,a){a&&this.filter(a);this.writeChildrenHtml(b)},writeChildrenHtml:function(b,a,e){var f=this.getFilterContext();if(e&&!this.parent&&a)a.onRoot(f,this);a&&this.filterChildren(a,!1,f);a=0;e=this.children;for(f=e.length;a<f;a++)e[a].writeHtml(b)},forEach:function(b,a,e){if(!(e||a&&this.type!=a))var f=b(this);if(!1!==f){e=this.children;for(var m=0;m<e.length;m++)f=e[m],f.type==CKEDITOR.NODE_ELEMENT?f.forEach(b,a):a&&f.type!=a||b(f)}},getFilterContext:function(b){return b||
{}}}})();